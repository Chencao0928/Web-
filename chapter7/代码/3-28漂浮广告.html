
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>漂浮广告</title>


</head>

<body>
<div id="Ad" style="position:absolute">
<a href="http://www.baidu.com" target="_blank"><img src="images/04.jpg" border="0"></a>
</div>
<script> 
var x = 50,y = 60;				//设置元素在浏览器窗口中的初始位置
var xin = true, yin = true; 		//设置xin、yin用于判断元素是否在窗口范围内
var step = 1 ; 				//可设置每次移动几像素
var obj=document.getElementById("Ad"); 		//通过id获取div元素
function floatAd() { 
var L=T=0;
var R= document.body.clientWidth-obj.offsetWidth; //浏览器的宽度减div对象占据的空间宽度就是元素可以到达的窗口最右边的位置
var B = document.body.clientHeight-obj.offsetHeight; 
obj.style.left = x + document.documentElement.scrollLeft;	//设置div对象的初始位置
//当没有拉到滚动条时，document.body.scrollTop的值是0，当拉到滚动条时，为了让div对象在屏幕中的位置保持不变，就需要加上滚动的网页的高度
obj.style.top = y + document.documentElement.scrollTop; 
x = x + step*(xin?1:-1); 		//水平移动对象，每次判断左移还是右移
if (x < L) { xin = true; x = L;} 
if (x > R){ xin = false; x = R;} //当div移动到最右边，x大于R时，设置xin = false，让x每次都减1，即向左移动，直到x< L时，再将xin的值设为true，让对象向右移动
y = y + step*(yin?1:-1) 
if (y < T) { yin = true; y = T; }
if (y > B) { yin = false; y = B;} 
} 
var itl= setInterval("floatAd()", 10) 	//每隔10毫秒执行一次floatAd()
obj.onmouseover=function(){clearInterval(itl)} 	//鼠标滑过时，让漂浮广告停止
obj.onmouseout=function(){itl=setInterval("floatAd()", 10)} //鼠标离开时，继续移动
</script>
</body>
</html>
